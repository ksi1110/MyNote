#### 扫描技术优势：扫描、自动化、提高效率

1. 资产发现
   1. 发现目标环境中有哪些资产，包含物理机、虚拟机、所有联网的设备、主机、服务器、和各种运行的服务
2. 资产整理，资产收集等
3. 主机发现
   1. 通过扫描确定哪些主机在线，判定IP地址是否可以访问，基本都是TCP/IP协议簇
4. 端口扫描，先扫描端口，再扫描端口上运行的服务，因为端口关联的服务可以修改，默认只扫描1000个端口
   1. 开启的端口
   2. 端口上的服务
5. 扫描方式
   1. TCP，全链接扫描，建立完整的TCP三次握手
   2. SYN，半链接扫描，
   3. 隐蔽扫描，只适用于windows系统
      1. null扫描
      2. Xmas扫描
      3. FIN扫描

6. nmap扫描端口状态共6种
   1. 开放
   2. 关闭
   3. 过滤
   4. 未识别
   5. 开放|过滤
   6. 关闭|过滤

7. 时序扫描，nmap -T1~T5，扫描强度依次递增，默认T3，如果有防火墙建议T1级别

#### nmap的使用

跨平台工具，kali中已经集成，windows下有图形化界面

虚拟机中使用nmap需要桥接网卡

##### 常用命令

nmap    [参数]    IP

nmap    IP，直接扫描，在没有指定端口的情况下，默认只扫描1000个端口

常用参数：

| 参数 | 释义                                       | 示例                   | 备注                       |
| :--- | ------------------------------------------ | :--------------------- | -------------------------- |
| -sn  | 只进行主机发现，不进行端口扫描             | nmap 10.0.105.0/24 -sn |                            |
| -sP  | ping扫描判断主机存活，只有存活nmap才会继续 | nmap 10.0.105.0/24 -sP | 一般不加，有的主机禁止ping |

-P参数

| 参数             | 释义                   | 示例                                | 备注 |
| :--------------- | :--------------------- | :---------------------------------- | :--: |
| -p               | 指定端口               | nmap -p 80 10.0.105.0/24            |      |
| -p 1-80          | 扫描端口范围           | nmap -p 1-80 10.0.105.0/24          |      |
| -p 80,3389,22,21 | 扫描多个端口           | nmap -p 80,3389,22,21 10.0.105.0/24 |      |
| -p 1-80,3389,80  | 指定端口范围和多个端口 | nmap -p 1-80,3389,80 10.0.105.0/24  |      |
| -p 1-65535       | 指定所有的端口         | nmap -p 1-65535 10.0.105.0/24       |      |
| -p-              | 指定所有的端口         | nmap -p- 10.0.105.0/24              |      |

TCP全连接扫描、SYN半链接扫描、隐蔽扫描，通过wireshark抓包，过滤ip地址和端口进行分析确认

| 参数 | 释义               | 示例                                      | 备注                             |
| ---- | ------------------ | ----------------------------------------- | -------------------------------- |
| -sT  | TCP全链接扫描      | nmap 10.0.105.1 -p 80 -sT                 | TCP三次握手                      |
| -sS  | SYN半链接扫描      | nmap 10.0.105.1 -p 80 -sS                 | 只进行三次握手的前两次握手       |
| -sN  | null扫描           | nmap 10.0.105.1 -p 80 -sN                 | 标志位全为0，访问后直接丢弃      |
| -sX  | Xmas扫描           | nmap 10.0.105.1 -p 80 -sX                 |                                  |
| -sF  | Fin扫描            | nmap 10.0.105.1 -p 80 -sF                 |                                  |
| -sV  | 显示服务的详细版本 | nmap 127.0.0.1 -p 22 -sV                  |                                  |
| -O   | 显示操作系统类型   |                                           | 显示不准确，需要综合性判断       |
| -oN  | 保存结果为txt格式  | nmap -oN 路径 nmap.result 127.0.0.1 -p 22 | 可以写具体路径，可以不写默认当前 |
| -oX  | 保存结果为xml格式  | nmap -oX 路径 nmap.xml 127.0.0.1 -p 22    | 可以写具体路径，可以不写默认当前 |
| -A   | 全面扫描           | nmap -p- -A 127.0.0.1 -oN reslut.txt      | 最终命令，扫描所有端口所有选项   |

#### wireshark使用

对于对应网卡进行抓包，并过滤结果，ip.addr == 192.168.67.1 and tcp.port == 80
